From: https://github.com/AOSC-Dev/aosc-os-abbs/blob/c5478da15c8b634002855fa112b7b203cd396f90/app-devel/intel-graphics-compiler/autobuild/patches/0001-igc-support-loongarch64.patch.loongarch64

Last-Update: 2025-07-15

Index: intel-graphics-compiler2-2.9.2/visa/iga/IGALibrary/api/igad.h
===================================================================
--- intel-graphics-compiler2-2.9.2.orig/visa/iga/IGALibrary/api/igad.h
+++ intel-graphics-compiler2-2.9.2/visa/iga/IGALibrary/api/igad.h
@@ -19,6 +19,8 @@ SPDX-License-Identifier: MIT
 #define CDECLATTRIBUTE
 #elif defined(__ARM_ARCH)
 #define CDECLATTRIBUTE
+#elif (defined(__riscv) && __riscv_xlen == 64)
+#define CDECLATTRIBUTE
 #else
 #define CDECLATTRIBUTE __attribute__((__cdecl__))
 #endif
Index: intel-graphics-compiler2-2.9.2/IGC/AdaptorOCL/OCL/sp/sp_debug.cpp
===================================================================
--- intel-graphics-compiler2-2.9.2.orig/IGC/AdaptorOCL/OCL/sp/sp_debug.cpp
+++ intel-graphics-compiler2-2.9.2/IGC/AdaptorOCL/OCL/sp/sp_debug.cpp
@@ -21,6 +21,8 @@ namespace iOpenCL
 
 #if __ARM_ARCH
 void DebugMessageStr(std::string& output, unsigned int ulDebugLevel, const char* fmt, ...)
+#elif (defined(__riscv) && __riscv_xlen == 64)
+void DebugMessageStr(std::string& output, unsigned int ulDebugLevel, const char* fmt, ...)
 #else
 void __cdecl DebugMessageStr(std::string& output, unsigned int ulDebugLevel, const char* fmt, ...)
 #endif
Index: intel-graphics-compiler2-2.9.2/IGC/common/ShaderOverride.cpp
===================================================================
--- intel-graphics-compiler2-2.9.2.orig/IGC/common/ShaderOverride.cpp
+++ intel-graphics-compiler2-2.9.2/IGC/common/ShaderOverride.cpp
@@ -50,7 +50,7 @@ static void * GetProcAddress(
 #if defined(WIN32)
 #define CDECLATTRIBUTE __cdecl
 #elif __GNUC__
-#if defined(__x86_64__) || defined(__ARM_ARCH)
+#if defined(__x86_64__) || defined(__ARM_ARCH) || (defined(__riscv) && __riscv_xlen == 64)
 #define CDECLATTRIBUTE
 #else
 #define CDECLATTRIBUTE                 __attribute__((__cdecl__))
